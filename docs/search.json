[
  {
    "objectID": "stat_modelling.html",
    "href": "stat_modelling.html",
    "title": "stat_modelling",
    "section": "",
    "text": "In this project we will be using a subset of the data from the Behavioral Risk Factor Surveillance System (BRFSS) from the CDC to investigate possible risk factors for arthritis. The BRFSS is a system of health-related telephone surveys that collect state data about U.S. residents regarding their health-related risk behaviors, chronic health conditions, and use of preventive services. It was established in 1984 with 15 states, BRFSS now collects data in all 50 states. This dataset contains health and social information about non-institutionalized adults in the US in 2013. There are 359,925 individuals included (rows) and 16 variables (columns). The goal is of the study is to investigate risk factors associated with arthritis."
  },
  {
    "objectID": "stat_modelling.html#removing-outliers",
    "href": "stat_modelling.html#removing-outliers",
    "title": "stat_modelling",
    "section": "Removing outliers",
    "text": "Removing outliers\n\nQ &lt;- quantile(lean_brfss$bmi, probs=c(.25, .75), na.rm = FALSE) # Specifying the lower and upper quatiles\niqr &lt;- IQR(lean_brfss$bmi) # Interquatile range\nup &lt;-  Q[2]+1.5*iqr # Upper Range  \nlow&lt;- Q[1]-1.5*iqr # Lower Range\nbrfss_eliminated&lt;- subset(lean_brfss, lean_brfss$bmi &gt; (Q[1] - 1.5*iqr) & lean_brfss$bmi &lt; (Q[2]+1.5*iqr))\n\n\nwith_outliers&lt;-lean_brfss |&gt; \n  ggplot(aes(x = bmi)) +\n  geom_boxplot(aes(),color = \"steelblue\") +\n  coord_flip() +\n  #facet_grid(~arthritis)+\n  theme_bw() +\n  labs(title = \"With outliers\")\n\n\nwithout_outliers&lt;-brfss_eliminated |&gt; \n  ggplot(aes(x = bmi)) +\n  geom_boxplot(aes(),color = \"steelblue\") +\n  coord_flip() +\n  #facet_grid(~arthritis)+\n  theme_bw() +\n  labs(title = \"Without outliers\")\n\n\ncowplot::plot_grid(with_outliers, without_outliers)\n\n\n\n\n\n\n\n\n\nbrfss_eliminated |&gt; \n  ggplot(aes(x = bmi))+\n  geom_histogram(aes(y = after_stat(density), fill = ..count..),bins = 30)+\n  facet_grid(~arthritis) +\n  theme_bw()\n\nWarning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.\nℹ Please use `after_stat(count)` instead.\n\n\n\n\n\n\n\n\n\n\nsex_subt&lt;-brfss_eliminated |&gt; \n  select(Sex,arthritis)\n\nactivity_subt&lt;-brfss_eliminated |&gt; \n  select(physical_activity,arthritis)\n\nage_subt&lt;-brfss_eliminated |&gt; \n  select(age_65_or_over,arthritis)\n\n\nsex_subt |&gt; \n  tbl_cross(row = Sex,\n            col = arthritis,\n            percent = \"column\") |&gt; \n  bold_labels()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\narthritis\n\nTotal\n\n\nYes\nNo\n\n\n\n\nSex\n\n\n\n\n\n\n\n\n    Female\n71,737 (63%)\n124,693 (53%)\n196,430 (56%)\n\n\n    Male\n42,144 (37%)\n109,887 (47%)\n152,031 (44%)\n\n\nTotal\n113,881 (100%)\n234,580 (100%)\n348,461 (100%)\n\n\n\n\n\n\n\n\nactivity_subt |&gt; \n  tbl_cross(row = physical_activity,\n            col = arthritis,\n            percent = \"column\") |&gt; \n  bold_labels()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\narthritis\n\nTotal\n\n\nYes\nNo\n\n\n\n\nphysical_activity\n\n\n\n\n\n\n\n\n    No\n36,915 (32%)\n51,544 (22%)\n88,459 (25%)\n\n\n    Yes\n76,966 (68%)\n183,036 (78%)\n260,002 (75%)\n\n\nTotal\n113,881 (100%)\n234,580 (100%)\n348,461 (100%)\n\n\n\n\n\n\n\n\nage_subt |&gt; \n  tbl_cross(row = age_65_or_over,\n            col = arthritis,\n            percent = \"column\") |&gt; \n  bold_labels()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\narthritis\n\nTotal\n\n\nYes\nNo\n\n\n\n\nage_65_or_over\n\n\n\n\n\n\n\n\n    Yes\n56,240 (49%)\n51,271 (22%)\n107,511 (31%)\n\n\n    No\n57,641 (51%)\n183,309 (78%)\n240,950 (69%)\n\n\nTotal\n113,881 (100%)\n234,580 (100%)\n348,461 (100%)\n\n\n\n\n\n\n\n\nbrfss_eliminated %&gt;% \n  count(Sex, arthritis) %&gt;%\n  ggplot(aes(x = Sex, \n             y = arthritis)) +\n  geom_tile(aes(fill=n)) +\n  labs(x = \"Sex\",\n       y = \"Arthritis\",\n       fill = \"Count\") +\n  scale_fill_distiller(palette = \"RdPu\") +\n  theme_classic(base_size = 16)"
  },
  {
    "objectID": "stat_modelling.html#observations",
    "href": "stat_modelling.html#observations",
    "title": "stat_modelling",
    "section": "Observations",
    "text": "Observations\nThe box plots show higher median BMI in the arthritis group with just fewer outliers after filtering. Histograms show a right skewed distribution where as contingency tables suggest higher arthritis prevalence among females (63%), those aged 65 or over (49% vs 22%), and those with no physical activity. the distribution of BMI as a variable indicates skewness and presence of outliers. This variables will be transformed prior to analysis."
  },
  {
    "objectID": "stat_modelling.html#data-dictionary",
    "href": "stat_modelling.html#data-dictionary",
    "title": "stat_modelling",
    "section": "Data dictionary",
    "text": "Data dictionary\n\nArthritis: A binary outcome variable taking the values of Yes(1), and No(2).\nPhysical activity: A binary explanatory variable taking the values of Yes(1), or No(2) to indicate whether an individual is exercising or not respectively.\nAge 65 or over: A binary explanatory variable taking the values of Yes(1), or No(2) to indicate whether or not the individual is above or below 65 years of age respectively.\nSex: A binary explanatory variable taking the values of Female(1), or Male(2) to indicate whether or not the individual is Female or Male respectively.\nBMI: A numeric continuous variable showing the Body Mass Index (BMI) for an individual."
  },
  {
    "objectID": "stat_modelling.html#data-transformation",
    "href": "stat_modelling.html#data-transformation",
    "title": "stat_modelling",
    "section": "Data Transformation",
    "text": "Data Transformation\nObservations from the visual inspection of the data, show that the bmi variable is not normally distributed, as the histograms and Q-Q plots have longer tails to the right, and data points deviating from red line respectively. Below, we are methods to transform the variable (bmi) using the three methods.\n\nLog transformation\n\nlean_brfss |&gt; \n  ggplot(aes(x = log(bmi)))+\n  geom_histogram(aes(y = after_stat(density), \n                     fill = ..count..))+\n  #geom_density(aes(y = after_stat(density)), color = \"red\", linewidth = 1) +\n  geom_vline(xintercept = mean(log(lean_brfss$bmi)), \n             color = \"purple\", linewidth = 0.8)+\n  geom_vline(xintercept = median(log(lean_brfss$bmi)), \n             color = \"orange\", linewidth = 0.8)+\n  facet_grid(~arthritis) +\n  theme_bw()\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\n\n\n\nSquare root transformation\n\nlean_brfss |&gt; \n  ggplot(aes(x = sqrt(bmi)))+\n  geom_histogram(aes(y = after_stat(density), \n                     fill = ..count..))+\n  #geom_density(aes(y = after_stat(density)), color = \"red\", linewidth = 1) +\n  geom_vline(xintercept = mean(sqrt(lean_brfss$bmi)), \n             color = \"purple\", linewidth = 0.8)+\n  geom_vline(xintercept = median(sqrt(lean_brfss$bmi)), \n             color = \"orange\", linewidth = 0.8)+\n  facet_grid(~arthritis) +\n  theme_bw()\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\n\n\n\nSquare transformation\n\nlean_brfss |&gt; \n  ggplot(aes(x = (bmi^2)))+\n  geom_histogram(aes(y = after_stat(density), \n                     fill = ..count..))+\n  #geom_density(aes(y = after_stat(density)), color = \"red\", linewidth = 1) +\n  geom_vline(xintercept = mean((lean_brfss$bmi^2)), \n             color = \"purple\", linewidth = 0.8)+\n  geom_vline(xintercept = median((lean_brfss$bmi^2)), \n             color = \"orange\", linewidth = 0.8)+\n  facet_grid(~arthritis) +\n  theme_bw()\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\n\nFrom the above outputs we can see that all methods of data transformation have not been able to result in normal distribution of bmi. Since graphic visualizations of tests are necessary but not sufficient we have further used the Shapiro test of significance below."
  },
  {
    "objectID": "stat_modelling.html#test-of-signifcance",
    "href": "stat_modelling.html#test-of-signifcance",
    "title": "stat_modelling",
    "section": "Test of signifcance",
    "text": "Test of signifcance\nUsing a sample of 4999 observations from the main dataset, we test for normality using the Shapiro Wilks test.\n\nset.seed(1234) # for reproducibility\nbmi_sample&lt;-lean_brfss |&gt;\n  select(bmi) |&gt; \n  drop_na(bmi) |&gt; \n  sample_n(4999) \n\nbmi_sample |&gt; \n  pull(bmi) |&gt; \n  shapiro.test()\n\n\n    Shapiro-Wilk normality test\n\ndata:  pull(bmi_sample, bmi)\nW = 0.91633, p-value &lt; 2.2e-16\n\n\nThe test results from the test show that firstly, the test statistic of 0.69345 is far from 1, indicating the deviation from the mean. The p-value is significant, is extremely low showing that there is strong evidence to reject the null hypothesis, and conclude that data for bmi is not coming from a normally distributed population.\nAll the assumptions except for chi-square test of independence have not been met for both the graphics, and significance tests. Since parametric methods such as students t tests, anova require data to be normally distributed, we are going to use non-parametric methods to analyse the dataset even as these methods have less power."
  },
  {
    "objectID": "stat_modelling.html#assessing-associations",
    "href": "stat_modelling.html#assessing-associations",
    "title": "stat_modelling",
    "section": "Assessing associations",
    "text": "Assessing associations\n\nsex_subt |&gt; \n  table() |&gt; \n  chisq.test()\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  table(sex_subt)\nX-squared = 3016, df = 1, p-value &lt; 2.2e-16\n\n\n\nage_subt |&gt; \n  table() |&gt; \n  chisq.test()\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  table(age_subt)\nX-squared = 27231, df = 1, p-value &lt; 2.2e-16\n\n\n\nactivity_subt |&gt; \n  table() |&gt; \n  chisq.test()\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  table(activity_subt)\nX-squared = 4413, df = 1, p-value &lt; 2.2e-16\n\n\n\nwilcox.test(bmi~arthritis,data=brfss_eliminated,conf.int=T)\n\n\n    Wilcoxon rank sum test with continuity correction\n\ndata:  bmi by arthritis\nW = 1.5633e+10, p-value &lt; 2.2e-16\nalternative hypothesis: true location shift is not equal to 0\n95 percent confidence interval:\n 1.489961 1.559952\nsample estimates:\ndifference in location \n              1.520008"
  },
  {
    "objectID": "stat_modelling.html#assessing-relative-risk-rr",
    "href": "stat_modelling.html#assessing-relative-risk-rr",
    "title": "stat_modelling",
    "section": "Assessing relative risk (RR)",
    "text": "Assessing relative risk (RR)\n\nsex_subt |&gt; \n  table() |&gt; \n  epitools::epitab(method=\"riskratio\")\n\n$tab\n        arthritis\nSex        Yes        p0     No        p1 riskratio    lower    upper p.value\n  Female 71737 0.3652039 124693 0.6347961  1.000000       NA       NA      NA\n  Male   42144 0.2772066 109887 0.7227934  1.138623 1.133424 1.143845       0\n\n$measure\n[1] \"wald\"\n\n$conf.level\n[1] 0.95\n\n$pvalue\n[1] \"fisher.exact\"\n\n\n\nage_subt |&gt; \n  table() |&gt; \n  epitools::epitab(method=\"riskratio\")\n\n$tab\n              arthritis\nage_65_or_over   Yes        p0     No        p1 riskratio    lower    upper\n           Yes 56240 0.5231093  51271 0.4768907  1.000000       NA       NA\n           No  57641 0.2392239 183309 0.7607761  1.595284 1.584712 1.605926\n              arthritis\nage_65_or_over p.value\n           Yes      NA\n           No        0\n\n$measure\n[1] \"wald\"\n\n$conf.level\n[1] 0.95\n\n$pvalue\n[1] \"fisher.exact\"\n\n\n\nactivity_subt |&gt; \n  table()|&gt; \n  epitools::epitab(method=\"riskratio\")\n\n$tab\n                 arthritis\nphysical_activity   Yes        p0     No        p1 riskratio  lower    upper\n              No  36915 0.4173120  51544 0.5826880  1.000000     NA       NA\n              Yes 76966 0.2960208 183036 0.7039792  1.208158 1.2008 1.215561\n                 arthritis\nphysical_activity p.value\n              No       NA\n              Yes       0\n\n$measure\n[1] \"wald\"\n\n$conf.level\n[1] 0.95\n\n$pvalue\n[1] \"fisher.exact\"\n\n\n\nmodel_data&lt;-brfss_eliminated |&gt; \n  select(arthritis,bmi,age_65_or_over,Sex,physical_activity)\n\nmodel_lr&lt;-glm(arthritis~.,data = model_data,family = binomial(\"logit\"))\nsummary(model_lr)\n\n\nCall:\nglm(formula = arthritis ~ ., family = binomial(\"logit\"), data = model_data)\n\nCoefficients:\n                       Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)           1.2621793  0.0228869   55.15   &lt;2e-16 ***\nbmi                  -0.0660347  0.0007623  -86.62   &lt;2e-16 ***\nage_65_or_overNo      1.2707663  0.0079701  159.44   &lt;2e-16 ***\nSexMale               0.4330701  0.0078421   55.22   &lt;2e-16 ***\nphysical_activityYes  0.3712731  0.0085998   43.17   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 440383  on 348460  degrees of freedom\nResidual deviance: 400874  on 348456  degrees of freedom\nAIC: 400884\n\nNumber of Fisher Scoring iterations: 4\n\nmodel_lr |&gt; \n  tbl_regression(exponentiate = TRUE, conf.int = TRUE) |&gt; \n  add_global_p() |&gt; \n  bold_labels() |&gt; \n  add_glance_table(include = c(nobs,BIC,AIC,logLik))\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nOR\n95% CI\np-value\n\n\n\n\nbmi\n0.94\n0.93, 0.94\n&lt;0.001\n\n\nage_65_or_over\n\n\n\n\n&lt;0.001\n\n\n    Yes\n—\n—\n\n\n\n\n    No\n3.56\n3.51, 3.62\n\n\n\n\nSex\n\n\n\n\n&lt;0.001\n\n\n    Female\n—\n—\n\n\n\n\n    Male\n1.54\n1.52, 1.57\n\n\n\n\nphysical_activity\n\n\n\n\n&lt;0.001\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.45\n1.43, 1.47\n\n\n\n\nNo. Obs.\n348,461\n\n\n\n\n\n\nBIC\n400,938\n\n\n\n\n\n\nAIC\n400,884\n\n\n\n\n\n\nLog-likelihood\n-200,437\n\n\n\n\n\n\n\nAbbreviations: CI = Confidence Interval, OR = Odds Ratio"
  },
  {
    "objectID": "stat_modelling.html#sex-and-arthritis",
    "href": "stat_modelling.html#sex-and-arthritis",
    "title": "stat_modelling",
    "section": "1. Sex, and Arthritis",
    "text": "1. Sex, and Arthritis\n\nChi-square test of indeoendence shows a statistically significant relationship between sex and arthritis (X-squared = 27231 = 3016, df = 1, p&lt;0.001), indicating that arthritis prevalence is different in males and females.\nRisk Ratio: Males have a lower risk of arthritis comppared to females (RR = 0.86, 95% CI: 0.86-0.88, p&lt;0.001). This means that the risk of arthritis in males is about 14% lower than in females.\nLogistic regression: Adjusted OR = 1.54 (95% CI: 1.52-1.57), p&lt;0.001. This means that after adjusting for BMI, age, and physical activity, females have 54% higher odds of having arthritis compared to males. The 95% confidence interval does not include 1, and extremely narrow indicating that the estimate is quite precise."
  },
  {
    "objectID": "stat_modelling.html#age-and-arthritis",
    "href": "stat_modelling.html#age-and-arthritis",
    "title": "stat_modelling",
    "section": "2. Age and Arthritis",
    "text": "2. Age and Arthritis\n\nChi-square test results show that there is a strong evidence of association between age (65and over) and arthritis (X-squared = 27231, df = 1, p &lt; 0.001). The p-value is less than 0.05, we therefore reject the null hypothesis, and conclude that the association between age and arthritis is not by chance.\nRisk Ratio: Individuals aged 65 or older have a relative risk of 2.18 (95% CI: 2.15-2.20, p &lt; 0.001), suggesting that they are more than twice as likely to have arthritis compared to individuals below 65.\n\nLogistic regression: Adjusted OR = 3.56 (95% CI: 3.51-3.62, p &lt; 0.001), showing that being 65 or older increases the odds of having arthritis by 3.5 times after adjusting for other variables. Again, the low p - value (less than 0.05) as well as the narrow confidence interval shows that the estimate is both significant and quite precise."
  },
  {
    "objectID": "stat_modelling.html#physical-activity-and-arthritis",
    "href": "stat_modelling.html#physical-activity-and-arthritis",
    "title": "stat_modelling",
    "section": "3. Physical Activity and Arthritis",
    "text": "3. Physical Activity and Arthritis\n\nChi-square test: The association between physical activity, and arthritis is significant (X-squared = 4413, df = 1, p &lt; 0.001). Given the small p value (less than 0.05), we reject the null hypothesis, and conclude that the difference is unlikely to be due to random variation alone.\nRisk Ratio: Individuals who are physically inactive have higher risk of developing athritis (RR = 1.21, 95% CI: 1.20-1.22, p &lt; 0.001), showing that there is a 21% increased risk compared to physically active individuals.\nLogistic regression: With Adjusted OR = 1.45 (95% CI: 1.43-1.47, p &lt; 0.001). This means that physical inactivity increases the odds of arthritis by 45% holding other variables constant.The p value is less than 0.05 (given alpha level), and therefore significant. Note that the confidence interval is narrow, and does not include 1 making the estimate so certain and precise."
  },
  {
    "objectID": "stat_modelling.html#bmi-and-arthritis",
    "href": "stat_modelling.html#bmi-and-arthritis",
    "title": "stat_modelling",
    "section": "4. BMI and Arthritis",
    "text": "4. BMI and Arthritis\n\nWilcoxon Rank-Sum Test (Mann-Whitney U Test): Since BMI is numeric and skewed, this test is ideal because it is non-parametric. The p - value is less than 0.05 (0.001), and the confidence interval is narrow(W-Statistic 1.52, 95% CI:1.49-1.56, p &lt; 0.001) and does not include 0, we reject the null hypothesis, and conclude that individuals with arthritis tend to have higher BMI than those without arthritis.\nLogistic regression: The adjusted OR = 0.94 (95% CI: 0.93-0.94, p &lt; 0.001) suggests that there is a 6% decrease in the odds of arthritis for every unit of BMI gained. Even as this is significant the result is inverse relationship could suggest possible confounding in our model."
  }
]